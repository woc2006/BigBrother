<!DOCTYPE html>
<html>
<head>
    <title>Unit Test Runner</title>
    <script type="text/javascript" src="./qunit-1.12.0.js"></script>
    <link rel="stylesheet" type="text/css" href="./qunit-1.12.0.css" media="all">
</head>
<body>
<div id="qunit"></div>
<div id="qunit-fixture"></div>

<script type="text/javascript">
    exports = {};
</script>
<script type="text/javascript" src="../proxy/rule.js"></script>
<script type="text/javascript">
    test('basic file reg build',function(){
        var input  = 'http://qzonestyle.gtimg.cn/qzone/phone/m/v4/manifest.js';
        var output = buildMatchReg(input);
        equal(output.source, 'http\\:\\/\\/qzonestyle\\.gtimg\\.cn\\/qzone\\/phone\\/m\\/v4\\/manifest\\.js(.+)?');

        var test1 = 'http://qzonestyle.gtimg.cn/qzone/phone/m/v4/manifest.js';
        var result1 = output.exec(test1);
        equal(result1.length, 2);
        deepEqual(result1[1],undefined);

        var test2 = 'http://qzonestyle.gtimg.cn/qzone/phone/m/v4/manifest.js?v=12345';
        var result2 = output.exec(test2);
        equal(result2.length, 2);
        deepEqual(result2[1],'?v=12345');

        var test3 = 'http://qzonestyle.gtimg.cn/qzone/phone/m/v4/manifest';
        var result3 = output.exec(test3);
        deepEqual(result3,null);
    });

    test('advanced file reg build',function(){
        var input  = 'qzonestyle.gtimg.cn/qzone/phone/m/v4/manifest.js?v=123';
        var output = buildMatchReg(input);
        equal(output.source, 'qzonestyle\\.gtimg\\.cn\\/qzone\\/phone\\/m\\/v4\\/manifest\\.js\\?v=123(.+)?');

        var test1 = 'http://qzonestyle.gtimg.cn/qzone/phone/m/v4/manifest.js';
        var result1 = output.exec(test1);
        equal(result1.length, 2);
        deepEqual(result1[1],undefined);

        var test2 = 'http://qzonestyle.gtimg.cn/qzone/phone/m/v4/manifest.js?v=12345';
        var result2 = output.exec(test2);
        equal(result2.length, 2);
        deepEqual(result2[1],'?v=12345');

        var test3 = 'http://qzonestyle.gtimg.cn/qzone/phone/m/v4/manifest';
        var result3 = output.exec(test3);
        deepEqual(result3,null);
    });

    test('basic directory reg build',function(){
        var input  = 'http://qzonestyle.gtimg.cn/qzone/phone/m/v4/';
        var output = buildMatchReg(input);
        equal(output.source, 'http\\:\\/\\/qzonestyle\\.gtimg\\.cn\\/qzone\\/phone\\/m\\/v4\\/(.+)?');

        var test1 = 'http://qzonestyle.gtimg.cn/qzone/phone/m/v4/manifest.js';
        var result1 = output.exec(test1);
        equal(result1.length, 2);
        deepEqual(result1[1],'manifest.js');

        var test2 = 'http://qzonestyle.gtimg.cn/qzone/phone/m/v4/manifest.js?v=12345';
        var result2 = output.exec(test2);
        equal(result2.length, 2);
        deepEqual(result2[1],'manifest.js?v=12345');

        var test3 = 'http://qzonestyle.gtimg.cn/qzone/phone/m/v4';
        var result3 = output.exec(test3);
        deepEqual(result3,null);
    });
</script>
</body>
</html>